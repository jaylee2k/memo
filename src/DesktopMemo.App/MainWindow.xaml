<Window x:Class="DesktopMemo.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:DesktopMemo.App.ViewModels"
        mc:Ignorable="d"
        Title="DesktopMemo"
        Height="780"
        Width="1300"
        MinHeight="680"
        MinWidth="1100">
    <DockPanel>
        <StatusBar DockPanel.Dock="Bottom">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusMessage}" />
            </StatusBarItem>
        </StatusBar>

        <TabControl>
            <TabItem Header="메모 관리">
                <Grid Margin="8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="3*" />
                    </Grid.ColumnDefinitions>

                    <GroupBox Grid.Column="0" Header="메모 그룹" Margin="4">
                        <DockPanel>
                            <StackPanel Orientation="Horizontal" DockPanel.Dock="Bottom" Margin="0,8,0,0">
                                <Button Content="추가" Command="{Binding AddGroupCommand}" Margin="0,0,6,0" Width="64" />
                                <Button Content="수정" Command="{Binding RenameGroupCommand}" Margin="0,0,6,0" Width="64" />
                                <Button Content="삭제" Command="{Binding DeleteGroupCommand}" Width="64" />
                            </StackPanel>

                            <TreeView Name="GroupTree"
                                      ItemsSource="{Binding GroupTree}"
                                      SelectedItemChanged="GroupTree_OnSelectedItemChanged">
                                <TreeView.ItemTemplate>
                                    <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                                        <TextBlock Text="{Binding Name}" />
                                    </HierarchicalDataTemplate>
                                </TreeView.ItemTemplate>
                            </TreeView>
                        </DockPanel>
                    </GroupBox>

                    <GroupBox Grid.Column="1" Header="메모 목록" Margin="4">
                        <DockPanel>
                            <StackPanel Orientation="Horizontal" DockPanel.Dock="Bottom" Margin="0,8,0,0">
                                <Button Content="메모 추가" Command="{Binding AddNoteCommand}" Width="88" />
                            </StackPanel>

                            <ListView ItemsSource="{Binding Notes}" SelectedItem="{Binding SelectedNote, Mode=TwoWay}">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="제목" Width="180" DisplayMemberBinding="{Binding Title}" />
                                        <GridViewColumn Header="알람" Width="50" DisplayMemberBinding="{Binding AlarmEnabled}" />
                                        <GridViewColumn Header="수정일" Width="130" DisplayMemberBinding="{Binding UpdatedText}" />
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </DockPanel>
                    </GroupBox>

                    <GroupBox Grid.Column="2" Header="메모 상세 / 편집" Margin="4">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <StackPanel Margin="8">
                                <TextBlock Text="제목" FontWeight="Bold" />
                                <TextBox Text="{Binding NoteTitle, UpdateSourceTrigger=PropertyChanged}" Margin="0,4,0,10" />

                                <TextBlock Text="내용 (Markdown) / 미리보기" FontWeight="Bold" />
                                <Grid Height="240" Margin="0,4,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBox Grid.Column="0"
                                             Text="{Binding NoteContent, UpdateSourceTrigger=PropertyChanged}"
                                             AcceptsReturn="True"
                                             VerticalScrollBarVisibility="Auto"
                                             Margin="0,0,6,0" />
                                    <Border Grid.Column="1" BorderThickness="1" BorderBrush="#DDDDDD">
                                        <WebBrowser x:Name="MarkdownPreviewBrowser" />
                                    </Border>
                                </Grid>

                                <UniformGrid Columns="3" Margin="0,0,0,10">
                                    <StackPanel Margin="0,0,6,0">
                                        <TextBlock Text="글꼴" FontWeight="Bold" />
                                        <ComboBox ItemsSource="{Binding FontFamilies}" SelectedItem="{Binding SelectedFontFamily, Mode=TwoWay}" />
                                    </StackPanel>
                                    <StackPanel Margin="0,0,6,0">
                                        <TextBlock Text="크기" FontWeight="Bold" />
                                        <TextBox Text="{Binding FontSize, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="색상(HEX)" FontWeight="Bold" />
                                        <TextBox Text="{Binding FontColorHex, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                </UniformGrid>

                                <UniformGrid Columns="3" Margin="0,0,0,10">
                                    <StackPanel Margin="0,0,6,0">
                                        <TextBlock Text="굵기" FontWeight="Bold" />
                                        <ComboBox ItemsSource="{Binding FontWeights}" SelectedItem="{Binding SelectedFontWeight, Mode=TwoWay}" />
                                    </StackPanel>
                                    <StackPanel Margin="0,0,6,0">
                                        <TextBlock Text="기울임" FontWeight="Bold" />
                                        <ComboBox ItemsSource="{Binding FontStyles}" SelectedItem="{Binding SelectedFontStyle, Mode=TwoWay}" />
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="기타" FontWeight="Bold" />
                                        <CheckBox Content="밑줄" IsChecked="{Binding IsUnderline, Mode=TwoWay}" Margin="0,4,0,0" />
                                    </StackPanel>
                                </UniformGrid>

                                <Separator Margin="0,0,0,10" />

                                <CheckBox Content="알람 사용" IsChecked="{Binding AlarmEnabled, Mode=TwoWay}" Margin="0,0,0,8" />
                                <UniformGrid Columns="4" Margin="0,0,0,10">
                                    <StackPanel Margin="0,0,6,0">
                                        <TextBlock Text="알람 날짜" FontWeight="Bold" />
                                        <DatePicker SelectedDate="{Binding AlarmLocalDate, Mode=TwoWay}" />
                                    </StackPanel>
                                    <StackPanel Margin="0,0,6,0">
                                        <TextBlock Text="알람 시간(HH:mm)" FontWeight="Bold" />
                                        <TextBox Text="{Binding AlarmTimeText, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Margin="0,0,6,0">
                                        <TextBlock Text="반복" FontWeight="Bold" />
                                        <ComboBox ItemsSource="{Binding RepeatTypes}" SelectedItem="{Binding SelectedRepeatType, Mode=TwoWay}" />
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBlock Text="반복 종료일" FontWeight="Bold" />
                                        <DatePicker SelectedDate="{Binding RepeatEndLocalDate, Mode=TwoWay}" />
                                    </StackPanel>
                                </UniformGrid>

                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <Button Content="스누즈 5분" Command="{Binding Snooze5Command}" Width="90" Margin="0,0,8,0" />
                                    <Button Content="스누즈 10분" Command="{Binding Snooze10Command}" Width="90" Margin="0,0,8,0" />
                                    <Button Content="스누즈 30분" Command="{Binding Snooze30Command}" Width="90" Margin="0,0,8,0" />
                                    <Button Content="알람 해제" Command="{Binding DismissAlarmCommand}" Width="90" />
                                </StackPanel>

                                <Separator Margin="0,0,0,10" />

                                <StackPanel Orientation="Horizontal">
                                    <Button Content="삭제" Command="{Binding DeleteNoteCommand}" Width="80" Margin="0,0,8,0" />
                                    <ComboBox Width="180"
                                              ItemsSource="{Binding AllGroupsFlat}"
                                              DisplayMemberPath="Name"
                                              SelectedItem="{Binding MoveTargetGroup, Mode=TwoWay}" />
                                    <Button Content="다른 그룹으로 이동"
                                            Command="{Binding MoveNoteCommand}"
                                            Width="130"
                                            Margin="8,0,8,0" />
                                    <Button Content="Sticky 열기" Command="{Binding OpenStickyCommand}" Width="90" />
                                </StackPanel>
                            </StackPanel>
                        </ScrollViewer>
                    </GroupBox>
                </Grid>
            </TabItem>

            <TabItem Header="휴지통">
                <Grid Margin="8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <DataGrid Grid.Row="0"
                              AutoGenerateColumns="False"
                              ItemsSource="{Binding TrashItems}"
                              SelectedItem="{Binding SelectedTrashItem, Mode=TwoWay}"
                              IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="유형" Binding="{Binding ItemTypeText}" Width="120" />
                            <DataGridTextColumn Header="이름" Binding="{Binding Name}" Width="*" />
                            <DataGridTextColumn Header="삭제일" Binding="{Binding DeletedText}" Width="200" />
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,8,0,0">
                        <Button Content="복구" Command="{Binding RestoreTrashItemCommand}" Width="80" Margin="0,0,8,0" />
                        <Button Content="선택 영구삭제" Command="{Binding DeleteTrashItemPermanentlyCommand}" Width="110" Margin="0,0,8,0" />
                        <Button Content="90일 경과 정리" Command="{Binding PurgeExpiredTrashCommand}" Width="120" Margin="0,0,8,0" />
                        <Button Content="휴지통 비우기" Command="{Binding EmptyTrashCommand}" Width="100" />
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>
    </DockPanel>
</Window>
